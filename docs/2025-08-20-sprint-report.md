# Отчёт по работам (12–20 августа 2025)

Формат: дата — название задачи — краткое описание — оценка времени (Senior, с ИИ).

- 2025-08-12 — Главная без PartsAPI — отключены обращения к PartsAPI/PartsIndex для изображений на главной, карточки используют проп/фолбэк — 2.5 ч
- 2025-08-13 — Ограничение доступа + /login-required — закрыты разделы, требующие авторизации, добавлена страница уведомления — 3 ч
- 2025-08-14 — Админка: группировка сайдбара — пункты разбиты на тематические группы, улучшена навигация — 2 ч
- 2025-08-14 — CMS: модуль управления SEO — GraphQL/Prisma/админ‑UI для SEO конфигов + интеграция на фронт/SSR — 4 ч
- 2025-08-14 — SEO: robots.txt и sitemap.xml — динамические endpoints с приоритетами/частотами — 2 ч
- 2025-08-19 — Глобальные прелоадеры — фронт оверлей + CMS роут‑прелоадер, фикс счётчика активных запросов — 1.5 ч
- 2025-08-19 — Чат с ИИ (OpenAI GPT‑5) — прямое подключение, стриминг, конфиг через ENV — 1 ч
- 2025-08-19 — Ozon: раздел импорта/обновления — пагинация, батч‑детали, бренд/OEM, импорт медиа в S3, тосты — 3.5 ч
- 2025-08-19 — Удаление PartsAPI/PartsIndex — вычищены сервисы/запросы/UI, no‑op заглушки, ENV/Docker — 2 ч
- 2025-08-20 — Единый ЛК /profile-set — редиректы/ссылки, DaData по ИНН через CMS‑прокси, Apollo errorLink + CORS, тосты, стили кнопок, «Реквизиты» на /profile‑req, компактный бейдж юрлица — 8 ч
- 2025-08-21 — CMS: перенос «ZZAP статистика» в «Инструменты» — обновление сайдбара и документации — 0.2 ч
- 2025-08-21 — CMS: кнопка «Открыть на сайте» в каталоге — быстрая ссылка на карточку фронтенда — 0.3 ч
- 2025-08-24 — Главная: переход в карточку товара — кликабельные карточки в блоках, формирование URL и предотвращение всплытия на кнопках — 0.5 ч
- 2025-08-24 — Карточка: корректные фото товара — приоритет CMS-изображений, отключение PartsIndex влияния — 0.5 ч
 - 2025-08-24 — Карточка: фильтр мокап-фото — исключение/понижение приоритета общих мокапов — 0.3 ч
 - 2025-08-24 — CMS: API 1С — пакетный upsert каталога (auth, валидация, нормализация, категории/характеристики/изображения, частичный успех) — 3.5 ч
 - 2025-08-24 — CMS: страница документации 1С в админке (вместо Swagger) — 0.6 ч
 - 2025-08-24 — CMS: пункт меню «Интеграции → 1С: Каталог» в сайдбаре — 0.1 ч
 - 2025-08-24 — Frontend: защита /profile-history (редирект на /login-required без токена) — 0.1 ч
 - 2025-08-24 — Frontend: модалка редактирования комментария авто в гараже — 0.3 ч
 - 2025-08-24 — Карточка: скрытие последнего мокап-фото — полное исключение плейсхолдеров при наличии реальных — 0.2 ч
- 2025-08-24 — Frontend: /profile-set — улучшение формы юрлица (primary кнопка «Получить по ИНН», карточка «Данные найдены», без подписи DaData, фикc опечатки «налогообложение») — 0.3 ч
 - 2025-08-25 — CMS: политика stack.env + правки DEPLOYMENT/README + .gitignore — 0.5 ч
 - 2025-08-25 — CMS: синхронизация env (env_file в compose, scripts/sync-env.sh, npm env:check/env:sync, DEPLOYMENT.md) — 1.5 ч
 - 2025-08-25 — CMS: подготовка и публикация в BivekiGroup/protek-cms (санитизация stack.env, stack.env.local, push) — 0.5 ч
 - 2025-08-25 — CMS: фиксы сборки/типов (Prisma уникальный ключ article+brand; заглушки PartsIndex/PartsAPI; иконка Clock title) — 2.0 ч
 - 2025-08-25 — Frontend: синхронизация env (env_file, scripts/sync-env.sh, stack.example.env, README) — 1.0 ч
 - 2025-08-25 — Frontend: вынос во внешний репозиторий (git subtree → BivekiGroup/protek-front) — 0.3 ч
 - 2025-08-25 — Frontend: карточка — безопасный HTML для описания, вывод характеристик, вес/габариты (CMS → PartsIndex при отсутствии) — 1.5 ч
 - 2025-08-25 — Frontend: устранение регрессии карточки (возврат совместимого GraphQL запроса) + док‑файл — 0.7 ч
 - 2025-08-25 — Frontend: футер — убраны ссылки на категории — 0.2 ч
 - 2025-08-25 — Frontend: карточка — галерея: отдельная кнопка "+" для открытия, клики по миниатюрам только меняют фото, в лайтбоксе стрелки/клавиши навигации — 0.6 ч
 - 2025-08-25 — Frontend: ЛК — объединение «Реквизиты» с «Настройки аккаунта» (интеграция блока на /profile-set, удаление отдельной страницы /profile-req с редиректом, правки меню/ссылок) — 0.6 ч
 - 2025-08-25 — Frontend: редизайн селектора юрлиц в реквизитах — заменил убогий HTML select на красивые карточки с радиокнопками, иконками и отображением количества счетов — 0.3 ч
 - 2025-08-25 — Frontend: фикс адресов доставки — восстановил поле deliveryAddresses в GET_CLIENT_ME запросе, добавил bound_card в enum YandexPaymentMethod (фронт + бэк) — 0.4 ч
 - 2025-08-25 — Frontend: замена alert/confirm на тосты и модалки — заменил все alert на react-hot-toast, создал красивую ConfirmationModal с чистым backdrop-blur без затемнения фона — 0.5 ч
 - 2025-08-25 — Frontend: обновление адреса компании — изменил адрес на Походный проезд, 4, Москва, 125373, офис 211/212 на странице контактов, карте и микроразметке — 0.3 ч
 - 2025-08-25 — Frontend: фикс авторизации — исправил проблему когда после входа нужно было обновлять страницу чтобы появился ЛК, добавил authTrigger для мгновенного обновления состояния — 0.2 ч
 - 2025-08-25 — Frontend: ограничение корзины для юрлиц — заблокировал оформление заказов для физлиц, автовыбор первого юрлица при наличии, предупреждения с ссылкой на добавление юрлица — 0.3 ч
 - 2025-08-25 — Frontend: удаление прелоадеров — убрал GlobalPreloader и RoutePreloader из фронта и CMS — 0.2 ч
 - 2025-08-25 — Frontend: полное удаление выбора физлица в корзине — убрал опцию "Физическое лицо" из дропдауна, оставил только юрлица с автовыбором первого — 0.1 ч

## Итого по дням

- 2025-08-12: 2.5 ч
- 2025-08-13: 3 ч
- 2025-08-14: 8 ч
- 2025-08-19: 8 ч
- 2025-08-20: 9.2 ч

Суммарно: 30.7 ч

Дополнительно:

- 2025-08-24: 4.7 ч
 - 2025-08-25 — CMS: фикc GraphQL deleteProduct (резолвер, аудит) — 0.2 ч

Общий итог: 45.4 ч

Дополнение (2025-08-28):

- 2025-08-28 — CMS: Чат с ИИ → Polza.ai — переведён бэкенд-роут на Polza.ai (OpenAI-совместимый endpoint), поддержан SSE и fallback на JSON, конфиг через POLZA_AI_* — 1.2 ч
- 2025-08-28 — CMS/Frontend: удалён OpenAI/Vercel AI SDK — вычищены зависимости и импорты, чат на фронте переписан на нативный стрим `fetch + ReadableStream` — 1.0 ч
- 2025-08-28 — ENV: обновлён `.env` и `.env.example` — добавлены `POLZA_AI_API_KEY`, `POLZA_AI_MODEL`, `POLZA_AI_BASE_URL`, удалены `OPENAI_*` — 0.2 ч
- 2025-08-28 — 1C API: products — убран `retailPrice`, поле `price` трактуется как продажная цена, обязательен `category_code`, `externalId` по умолчанию = `article+"_"+brand` (lowercase), привязка к категории по `category_code` — 1.3 ч
- 2025-08-28 — 1C API: новые эндпоинты — `POST /api/1c/catalog/categories`, `POST /api/1c/catalog/prices`, `POST /api/1c/catalog/stocks`, `GET /api/1c/catalog/visits`, `GET /api/1c/catalog/clients` — 2.0 ч
- 2025-08-28 — CMS Docs: интеграция 1С — обновлены схемы/примеры на `/dashboard/integrations/1c-catalog` (curl для категорий/цен/остатков/посещений/контрагентов, обновлён upsert товаров) — 0.7 ч
- 2025-08-28 — Prisma: категория — добавлены поля `code` (unique), `headCode`, `headName`; указание на `npm run db:push` — 0.3 ч
